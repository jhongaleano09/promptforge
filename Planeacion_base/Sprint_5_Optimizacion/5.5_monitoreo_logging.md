# Tarea 5.5: Monitoreo y Logging

## üü¢ PRIORIDAD BAJA

## Objetivo
Configurar herramientas de monitoreo y logging estructurado.

## 1. Sentry (Error Tracking)

### Backend
```bash
poetry add sentry-sdk[fastapi]
```

```python
# main.py
import sentry_sdk

sentry_sdk.init(
    dsn=os.getenv("SENTRY_DSN"),
    traces_sample_rate=1.0,
    environment=os.getenv("ENV", "development")
)
```

### Frontend
```bash
npm install @sentry/nextjs
```

```typescript
// sentry.client.config.ts
Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  tracesSampleRate: 1.0,
});
```

## 2. Structured Logging

```python
# backend/app/logging_config.py
import logging
import json

class JSONFormatter(logging.Formatter):
    def format(self, record):
        log_data = {
            "timestamp": self.formatTime(record),
            "level": record.levelname,
            "message": record.getMessage(),
            "module": record.module,
        }
        return json.dumps(log_data)

# Configure
handler = logging.StreamHandler()
handler.setFormatter(JSONFormatter())
logging.root.addHandler(handler)
```

## 3. Analytics (Opcional)

### Posthog / Mixpanel
```typescript
// Track eventos importantes
analytics.track('prompt_generated', {
  provider: 'openai',
  model: 'gpt-4',
  prompt_type: 'system'
});
```

## 4. Health Checks

```python
# backend/app/api/health.py
@router.get("/health")
async def health_check():
    return {
        "status": "healthy",
        "timestamp": datetime.now().isoformat(),
        "version": "1.0.0"
    }

@router.get("/health/db")
async def db_health(db: Session = Depends(get_db)):
    try:
        db.execute("SELECT 1")
        return {"status": "healthy"}
    except Exception as e:
        return {"status": "unhealthy", "error": str(e)}
```

## Criterios de √âxito
- [ ] Sentry captura errores autom√°ticamente
- [ ] Logs estructurados en JSON
- [ ] Health checks funcionando
- [ ] Dashboards de m√©tricas (opcional)

‚ö†Ô∏è Actualizar PROGRESS.md al completar
