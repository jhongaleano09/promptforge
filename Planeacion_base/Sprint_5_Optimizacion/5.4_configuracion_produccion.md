# Tarea 5.4: Configuraci贸n de Producci贸n

##  PRIORIDAD CRTICA

## Objetivo
Preparar configuraci贸n segura para producci贸n.

## Environment Variables

### Backend (.env.production)
```bash
# Database
DATABASE_URL=postgresql://...  # Cambiar a PostgreSQL en prod

# Security
SECRET_KEY=<strong-random-key>
ENCRYPTION_KEY=<fernet-key>

# LLM Providers (opcional, mejor usar UI)
# OPENAI_API_KEY=sk-...

# CORS
ALLOWED_ORIGINS=https://promptforge.com

# Logging
LOG_LEVEL=INFO
SENTRY_DSN=https://...
```

### Frontend (.env.production)
```bash
NEXT_PUBLIC_API_URL=https://api.promptforge.com
NEXT_PUBLIC_SENTRY_DSN=https://...
```

## Secrets Management

### Opci贸n 1: Environment Variables (simple)
Configurar en plataforma de hosting (Vercel, Railway, etc.)

### Opci贸n 2: Secrets Manager (avanzado)
AWS Secrets Manager, Google Secret Manager, etc.

## Docker Optimization

**Crear**: `backend/Dockerfile.prod`

```dockerfile
FROM python:3.12-slim

WORKDIR /app

# Install dependencies
COPY pyproject.toml poetry.lock ./
RUN pip install poetry && poetry install --no-dev

# Copy code
COPY . .

# Run with gunicorn
CMD ["poetry", "run", "gunicorn", "app.main:app", "-k", "uvicorn.workers.UvicornWorker", "-w", "4", "-b", "0.0.0.0:8000"]
```

## Database Migration a PostgreSQL

```python
# config.py
import os

DATABASE_URL = os.getenv(
    "DATABASE_URL",
    "sqlite:///./promptforge.db"  # Fallback para desarrollo
)

# Usar PostgreSQL en producci贸n
if os.getenv("ENV") == "production":
    DATABASE_URL = os.getenv("DATABASE_URL").replace(
        "postgres://", "postgresql://"
    )
```

## Criterios de xito
- [ ] Todas las secrets en variables de entorno
- [ ] No hay API keys hardcoded
- [ ] PostgreSQL configurado para producci贸n
- [ ] Docker images optimizadas (< 500MB)
- [ ] HTTPS configurado
- [ ] CORS configurado correctamente

锔 Actualizar PROGRESS.md al completar
